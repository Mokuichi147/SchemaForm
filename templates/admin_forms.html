{% extends "base.html" %}
{% block content %}
<div class="flex flex-wrap items-center justify-between gap-3">
  <div>
    <h1 class="text-2xl font-semibold">フォーム一覧</h1>
    <p class="text-sm text-slate-600">作成済みフォームを管理します。</p>
  </div>
  <a href="/admin/forms/new" class="rounded bg-slate-900 px-4 py-2 text-sm font-semibold text-white">新規フォーム</a>
</div>

<div class="mt-6 overflow-x-auto rounded-lg border border-slate-200 bg-white">
  <table class="min-w-full divide-y divide-slate-200 text-sm">
    <thead class="bg-slate-100 text-left">
      <tr>
        <th class="px-4 py-3">フォーム名</th>
        <th class="px-4 py-3">状態</th>
        <th class="px-4 py-3">共有URL</th>
        <th class="px-4 py-3">更新</th>
        <th class="px-4 py-3">操作</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-slate-200">
      {% for form in forms %}
      <tr>
        <td class="px-4 py-3 font-medium">
          <a href="/admin/forms/{{ form.id }}" class="text-slate-900 hover:underline">{{ form.name }}</a>
          <div class="text-xs text-slate-500">{{ form.description }}</div>
        </td>
        <td class="px-4 py-3">
          {% if form.status == "active" %}
          <span class="whitespace-nowrap rounded-full bg-emerald-100 px-2 py-1 text-xs text-emerald-800">公開中</span>
          {% else %}
          <span class="whitespace-nowrap rounded-full bg-slate-200 px-2 py-1 text-xs text-slate-700">停止中</span>
          {% endif %}
        </td>
        <td class="px-4 py-3">
          <a href="/f/{{ form.public_id }}" class="text-slate-700 hover:underline">{{ form.public_id }}</a>
        </td>
        <td class="px-4 py-3 text-slate-600">
          <time class="js-local-dt" data-iso="{{ iso_dt(form.updated_at) }}">{{ format_dt(form.updated_at) }}</time>
        </td>
        <td class="px-4 py-3">
          <div class="flex flex-wrap gap-2">
            <a href="/admin/forms/{{ form.id }}" class="rounded border border-slate-300 px-2 py-1 text-xs">編集</a>
            <a href="/admin/forms/{{ form.id }}/submissions" class="rounded border border-slate-300 px-2 py-1 text-xs">送信一覧</a>
            {% if form.status == "active" %}
            <form method="post" action="/admin/forms/{{ form.id }}/stop">
              <button class="rounded border border-slate-300 px-2 py-1 text-xs">停止</button>
            </form>
            {% else %}
            <form method="post" action="/admin/forms/{{ form.id }}/publish">
              <button class="rounded border border-slate-300 px-2 py-1 text-xs">公開</button>
            </form>
            {% endif %}
          </div>
        </td>
      </tr>
      {% else %}
      <tr>
        <td colspan="5" class="px-4 py-6 text-center text-slate-500">フォームがまだありません。</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
